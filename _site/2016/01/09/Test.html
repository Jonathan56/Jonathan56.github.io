<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Uncontrolled-charging-car-model</title>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Sans+Pro:300,300i,600">
  <link rel="stylesheet" href="/style.css">
</head>
<body>
  <div class="container">
    <header class="masthead">
  <h1 class="masthead-title--small">
    <a href="/blog">&lArr; Jonathan&#39;s blog</a>
  </h1>
</header>
<div class="content post">
  <h1 class="post-title">Uncontrolled-charging-car-model</h1>
  <div class="post-date">
    <time>09 Jan 2016</time>
  </div>
  <p><strong>In [1]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>

<span class="c"># General imports</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">clear_output</span>

<span class="c"># Import V2G-Sim</span>
<span class="n">v2gSimPath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s">"../../v2g_sim"</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">v2gSimPath</span><span class="p">))</span>
<span class="kn">import</span> <span class="nn">core</span>
<span class="kn">import</span> <span class="nn">model</span>
<span class="kn">import</span> <span class="nn">itinerary.load</span>
<span class="kn">import</span> <span class="nn">result.vehicle_consumption</span> <span class="kn">as</span> <span class="nn">resultModule</span>

<span class="c"># Imports useful for graphics</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span>
<span class="n">seaborn</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s">"whitegrid"</span><span class="p">)</span>
<span class="n">seaborn</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="o">%</span><span class="n">config</span> <span class="n">InlineBackend</span><span class="o">.</span><span class="n">figure_formats</span> <span class="o">=</span> <span class="p">{</span><span class="s">'svg'</span><span class="p">,}</span></code></pre></figure>

<h2 id="v2g-sim-import-itineraries">V2G-Sim import itineraries</h2>

<p><strong>In [2]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># Initialize location and vehicles from excel file</span>
<span class="n">excelFilename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">v2gSimPath</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s">"../data/NHTS_data/Tennessee.xlsx"</span><span class="p">))</span>
<span class="n">vehicleList</span><span class="p">,</span> <span class="n">locationList</span> <span class="o">=</span> <span class="n">itinerary</span><span class="o">.</span><span class="n">load</span><span class="o">.</span><span class="n">excel</span><span class="p">(</span><span class="n">excelFilename</span><span class="p">)</span>

<span class="n">clear_output</span><span class="p">()</span></code></pre></figure>

<h2 id="define-functions-to-create-a-range-of-car-models">Define functions to create a range of car models</h2>

<p><strong>In [3]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># Define a function that update all vehicle with a new car model</span>
<span class="k">def</span> <span class="nf">set_car_model_all_vehicles</span><span class="p">(</span><span class="n">vehicleList</span><span class="p">,</span> <span class="n">carModel</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">vehicle</span> <span class="ow">in</span> <span class="n">vehicleList</span><span class="p">:</span>
        <span class="n">vehicle</span><span class="o">.</span><span class="n">carModel</span> <span class="o">=</span> <span class="n">carModel</span>

<span class="c"># Define a function that update all vehicle with one of the car model</span>
<span class="k">def</span> <span class="nf">set_fleet_mix</span><span class="p">(</span><span class="n">vehicleList</span><span class="p">,</span> <span class="n">carModelList</span><span class="p">,</span> <span class="n">percentageList</span><span class="p">):</span>
    <span class="c"># Determine how many vehicles for each model</span>
    
    <span class="c"># Randomly pick and remove vehicle from the pool to set their car model</span>
    <span class="k">return</span> <span class="bp">None</span>
        
<span class="c"># Define a function to save the result we need</span>
<span class="k">def</span> <span class="nf">save_result_and_reset</span><span class="p">(</span><span class="n">resultList</span><span class="p">,</span> <span class="n">vehicleList</span><span class="p">,</span> <span class="n">carModel</span><span class="p">,</span> <span class="n">powerDemand</span><span class="p">):</span>
    <span class="c"># Save power consumption</span>
    <span class="n">resultList</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s">'totalConsumption'</span><span class="p">:</span> <span class="n">powerDemand</span><span class="p">[</span><span class="s">'Total'</span><span class="p">],</span> <span class="s">'carModel'</span><span class="p">:</span> <span class="n">carModel</span><span class="p">})</span>
    <span class="n">resultList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s">'totalConsumption'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">resultList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s">'totalConsumption'</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1000</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span>  <span class="c"># From W to MW</span>
                                          <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">resultList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s">'totalConsumption'</span><span class="p">]))]</span>
    
    <span class="c"># Save avaerage SOC</span>
    <span class="n">resultList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s">'averageSOC'</span><span class="p">]</span> <span class="o">=</span> <span class="n">resultModule</span><span class="o">.</span><span class="n">get_average_SOC</span><span class="p">(</span><span class="n">vehicleList</span><span class="p">)</span>
    
    <span class="c"># Save stranded through the day</span>
    <span class="n">resultList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s">'stranded'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">vehicle</span> <span class="ow">in</span> <span class="n">vehicleList</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">vehicle</span><span class="o">.</span><span class="n">strandingLog</span><span class="p">:</span>
            <span class="n">resultList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s">'stranded'</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vehicle</span><span class="o">.</span><span class="n">strandingLog</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    
    <span class="c"># Reset the vehicle list</span>
    <span class="n">resultModule</span><span class="o">.</span><span class="n">reset_vehicle</span><span class="p">(</span><span class="n">vehicleList</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">resultList</span></code></pre></figure>

<h2 id="create-a-bunch-of-car-model">Create a bunch of car model</h2>

<p><strong>In [4]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># Set parameters for the model to generate</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">SimpleCarModel</span><span class="p">(</span><span class="s">"default Leaf"</span><span class="p">)</span>
<span class="n">carModelList</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span><span class="p">]</span>

<span class="c"># Set consumption</span>
<span class="k">for</span> <span class="n">percent</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">]:</span>
    <span class="n">carModelList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">SimpleCarModel</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">"Leaf "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">percent</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">+</span> <span class="s">" </span><span class="si">% </span><span class="s">"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">batteryCap</span><span class="p">)</span> <span class="o">+</span> <span class="s">' Wh'</span><span class="p">,</span>
                                             <span class="n">Delhi</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">Delhi</span> <span class="o">+</span> <span class="n">percent</span> <span class="o">*</span> <span class="n">d</span><span class="o">.</span><span class="n">Delhi</span><span class="p">,</span>
                                             <span class="n">UDDS</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">UDDS</span> <span class="o">+</span> <span class="n">percent</span> <span class="o">*</span> <span class="n">d</span><span class="o">.</span><span class="n">UDDS</span><span class="p">,</span> 
                                             <span class="n">HWFET</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">HWFET</span> <span class="o">+</span> <span class="n">percent</span> <span class="o">*</span> <span class="n">d</span><span class="o">.</span><span class="n">HWFET</span><span class="p">,</span>
                                             <span class="n">US06</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">US06</span> <span class="o">+</span> <span class="n">percent</span> <span class="o">*</span> <span class="n">d</span><span class="o">.</span><span class="n">US06</span><span class="p">,</span>
                                             <span class="n">batteryCap</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">batteryCap</span><span class="p">))</span>
<span class="c"># Set battery capacity</span>
<span class="k">for</span> <span class="n">percent</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">]:</span>
    <span class="n">carModelList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">SimpleCarModel</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">"Leaf "</span> <span class="o">+</span> <span class="s">"default "</span> <span class="o">+</span> 
                                             <span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">batteryCap</span> <span class="o">+</span> <span class="n">percent</span> <span class="o">*</span> <span class="n">d</span><span class="o">.</span><span class="n">batteryCap</span><span class="p">)</span> <span class="o">+</span> <span class="s">' Wh'</span><span class="p">,</span>
                                             <span class="n">Delhi</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">Delhi</span><span class="p">,</span>
                                             <span class="n">UDDS</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">UDDS</span><span class="p">,</span> 
                                             <span class="n">HWFET</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">HWFET</span><span class="p">,</span>
                                             <span class="n">US06</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">US06</span><span class="p">,</span>
                                             <span class="n">batteryCap</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">batteryCap</span> <span class="o">+</span> <span class="n">percent</span> <span class="o">*</span> <span class="n">d</span><span class="o">.</span><span class="n">batteryCap</span><span class="p">))</span>

<span class="c"># # Set battery capacity</span>
<span class="c"># for percent in [0.2, -0.2]:</span>
<span class="c">#     carModelList.append(model.SimpleCarModel(name="Leaf " + str(percent * 100) + " % " + </span>
<span class="c">#                                              str(d.batteryCap + percent * d.batteryCap) + ' Wh',</span>
<span class="c">#                                              Delhi=d.Delhi + percent * d.Delhi,</span>
<span class="c">#                                              UDDS=d.UDDS + percent * d.UDDS, </span>
<span class="c">#                                              HWFET=d.HWFET + percent * d.HWFET,</span>
<span class="c">#                                              US06=d.US06 + percent * d.US06,</span>
<span class="c">#                                              batteryCap=d.batteryCap + percent * d.batteryCap))</span></code></pre></figure>

<h2 id="launch-simulations">Launch simulations</h2>

<p><strong>In [5]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">resultList</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">carModel</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">carModelList</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Simulation number '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">+</span> <span class="s">' on '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">carModelList</span><span class="p">))</span> <span class="o">+</span> <span class="s">' simulations'</span> <span class="p">)</span>
    
    <span class="c"># Change car model and run V2G-Sim</span>
    <span class="n">set_car_model_all_vehicles</span><span class="p">(</span><span class="n">vehicleList</span><span class="p">,</span> <span class="n">carModel</span><span class="p">)</span>
    <span class="n">powerDemand</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">runV2GSim_reduce</span><span class="p">(</span><span class="n">vehicleList</span><span class="p">,</span> <span class="n">nbIteration</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    
    <span class="c"># Save result and reset for next iteration</span>
    <span class="n">resultList</span> <span class="o">=</span> <span class="n">save_result_and_reset</span><span class="p">(</span><span class="n">resultList</span><span class="p">,</span> <span class="n">vehicleList</span><span class="p">,</span> <span class="n">carModel</span><span class="p">,</span> <span class="n">powerDemand</span><span class="p">)</span>
    <span class="n">clear_output</span><span class="p">()</span></code></pre></figure>

<h2 id="plot-results">Plot results</h2>

<h3 id="total-consumption-for-all-simulations">1) Total consumption for all simulations</h3>

<p><strong>In [6]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># Plot the deviation energy domain</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
<span class="n">hourlySteps</span> <span class="o">=</span> <span class="mi">3600</span> <span class="o">/</span> <span class="n">vehicleList</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">outputInterval</span>
<span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">resultList</span><span class="p">:</span>
    <span class="c"># Create the x axis data</span>
    <span class="n">x</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s">'totalConsumption'</span><span class="p">]))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">hourlySteps</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))]</span>
    <span class="c"># Plot the data</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="s">'totalConsumption'</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">result</span><span class="p">[</span><span class="s">'carModel'</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Time of the day (hours)'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Power consumption (MW)'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Total consumption for '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vehicleList</span><span class="p">))</span> <span class="o">+</span> <span class="s">' vehicles'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure>

<p><img src="/assets/image/uncontrolled-charging-car-model_11_0.svg" alt="svg" /></p>

<h3 id="consumption-difference-between-2-simulations">2) Consumption difference between 2 simulations</h3>

<p><strong>In [7]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
<span class="n">hourlySteps</span> <span class="o">=</span> <span class="mi">3600</span> <span class="o">/</span> <span class="n">vehicleList</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">outputInterval</span>

<span class="c"># Plot difference between simulations (sim1 - sim2):</span>
<span class="n">index1</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">index2</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">consumptionDiff</span> <span class="o">=</span> <span class="p">[</span><span class="n">resultList</span><span class="p">[</span><span class="n">index1</span><span class="p">][</span><span class="s">'totalConsumption'</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">resultList</span><span class="p">[</span><span class="n">index2</span><span class="p">][</span><span class="s">'totalConsumption'</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">resultList</span><span class="p">[</span><span class="n">index1</span><span class="p">][</span><span class="s">'totalConsumption'</span><span class="p">]))]</span>
<span class="n">x</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">consumptionDiff</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">hourlySteps</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))]</span>

<span class="c"># Plot the data</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">consumptionDiff</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Time of the day (hours)'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Power consumption (MW)'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Difference of consumption between '</span> <span class="o">+</span> 
          <span class="n">resultList</span><span class="p">[</span><span class="n">index1</span><span class="p">][</span><span class="s">'carModel'</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">' and '</span> <span class="o">+</span> 
          <span class="n">resultList</span><span class="p">[</span><span class="n">index2</span><span class="p">][</span><span class="s">'carModel'</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure>

<p><img src="/assets/image/uncontrolled-charging-car-model_13_0.svg" alt="svg" /></p>

<h3 id="average-soc-for-all-simulations">3) Average SOC for all simulations</h3>

<p><strong>In [8]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># Plot the deviation energy domain</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
<span class="n">hourlySteps</span> <span class="o">=</span> <span class="mi">3600</span> <span class="o">/</span> <span class="n">vehicleList</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">outputInterval</span>
<span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">resultList</span><span class="p">:</span>
    <span class="c"># Create the x axis data</span>
    <span class="n">x</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s">'averageSOC'</span><span class="p">]))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">hourlySteps</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))]</span>
    <span class="c"># Plot the data</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="s">'averageSOC'</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">result</span><span class="p">[</span><span class="s">'carModel'</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Time of the day (hours)'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'SOC (</span><span class="si">%</span><span class="s">)'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Average SOC for '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vehicleList</span><span class="p">))</span> <span class="o">+</span> <span class="s">' vehicles'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure>

<p><img src="/assets/image/uncontrolled-charging-car-model_15_0.svg" alt="svg" /></p>

<h3 id="stranding-vehicles-throught-the-day-for-all-simulations">4) Stranding vehicles throught the day for all simulations</h3>

<p><strong>In [9]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">legend</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">resultList</span><span class="p">):</span>
    <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s">'stranded'</span><span class="p">])</span>
    <span class="n">legend</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s">'carModel'</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'For simulation with '</span> <span class="o">+</span> <span class="n">result</span><span class="p">[</span><span class="s">'carModel'</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">' there are '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s">'stranded'</span><span class="p">]))</span> <span class="o">+</span> 
         <span class="s">' vehicles that could not make it ('</span> <span class="o">+</span> <span class="s">'{:.2f}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s">'stranded'</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">vehicleList</span><span class="p">))</span> <span class="o">+</span> <span class="s">'</span><span class="si">%</span><span class="s">).'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Time of the day (hours)'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Number of stranded'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Stranded repartition throught out the day'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>For simulation with default Leaf there are 182 vehicles that could not make it (8.71%).
For simulation with Leaf 20.0 % 23832 Wh there are 250 vehicles that could not make it (11.96%).
For simulation with Leaf -20.0 % 23832 Wh there are 129 vehicles that could not make it (6.17%).
For simulation with Leaf default 28598.4 Wh there are 148 vehicles that could not make it (7.08%).
For simulation with Leaf default 19065.6 Wh there are 254 vehicles that could not make it (12.15%).
</code></pre>
</div>

<p><img src="/assets/image/uncontrolled-charging-car-model_17_1.svg" alt="svg" /></p>

<p><strong>In [None]:</strong></p>


</div>

  </div>
</body>
</html>
